POST /_scripts/ProducerConsumerRatio
{
  "script" : {
      "lang": "painless",
      "source": """
      /*Calculate producer consumer ratio from original and respond bytes in bro conn logs. */
      if (ctx.original_bytes!=null){
        float SourceBytes=ctx.original_bytes;
      }
      if (ctx.respond_bytes!=null){
        float RespondBytes=ctx.respond_bytes;
      }
      if (ctx.total_bytes!=null){
        float TotalBytes=ctx.total_bytes;
      }
      float PCR=0;
      if (TotalBytes!=0){
          PCR=(SourceBytes-RespondBytes)/TotalBytes;
        }

        ctx.ProducerConsumerRatio=PCR;
      """
  }

}
